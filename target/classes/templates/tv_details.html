<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta http-equiv="Content-Type" content="text/html"/>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}"/>

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="../../css/my_style.css" th:href="@{/css/my_style.css}"/>
    <link rel="stylesheet" href="../../fonts/ionicons.min.css" th:href="@{/fonts/ionicons.min.css}"/>
    <link rel="stylesheet" href="../../css/Footer-Clean.css" th:href="@{/css/Footer-Clean.css}"/>
    <link rel="stylesheet" href="../../css/star-rating.css" th:href="@{/css/star-rating.css}"/>
    <link rel="stylesheet" href="../../css/ratings.css" th:href="@{/css/ratings.css}"/>

    <title>TV Details</title>
</head>

<body>
<!-- Navbar -->
<div sec:authorize="isAnonymous()"><div th:replace="fragments/navbar">Navbar</div></div>
<div sec:authorize="hasRole('ROLE_USER')"><div th:replace="fragments/user_navbar">Navbar</div></div>
<div sec:authorize="hasRole('ROLE_ADMIN')"><div th:replace="fragments/admin_navbar">Navbar</div></div>

<!-- Details body -->
<div class="container">
    <div class="row">
        <!-- TV detail colum -->
        <div class="col-sm-12 col-md-12 col-lg-8">
            <h5 class="mr-2">THE X-FILES: SEASON 11 (2018)</h5>
            <form class="form-inline">
                <div class="form-group mb-2">
                    <label class="mr-3" for="season">Season:</label>
                    <select class="form-control form-control-sm" id="season">
                            <option>Season 11</option>
                            <option>Season 10</option>
                            <option>Season 9</option>
                            <option>Season 8</option>
                            <option>Season 7</option>
                            <option>Season 6</option>
                            <option>Season 5</option>
                            <option>Season 4</option>
                            <option>Season 3</option>
                            <option>Season 2</option>
                            <option>Season 1</option>
                    </select>
                </div>
            </form>

            <!-- TV details -->
            <div class="card detail-card flex-md-row mb-4 mt-2">
                <div class="card-poster-container align-items-center">
                    <img class="card-detail-poster" alt="poster" src="${tv.poster}"/>
                </div>
                <div class="card-body d-flex flex-column align-items-start">
                    <h5 class="mb-0">
                        <a class="detail-title" th:text="${tv.title}">TV Title</a>
                    </h5>
                    <div class="mb-1 text-muted" th:text="${tv.premierDate}">2018</div>
                    <div class="row w-100 ratings">
                        <div class="d-flex w-100">
                            <div class="p-2">Rating: </div>
                            <div class="p-2" th:text="${tv.rating}"><span class="ion-android-star"></span> 3.4</div>

                        </div>
                    </div>
                    <div class="d-flex w-100 mt-3 pl-3" >
                        <div style="font-size: 20px;">Add Your Rating</div>
                        <button type="button" class="btn btn-danger btn-sm ml-auto mr-1">+ Not Interested</button>
                        <button type="button" class="btn btn-primary btn-sm">+ Want To See List</button>
                    </div>
                    <form class="w-100">
                        <input id="rating" class="rating rating-loading" value="0" data-min="0" data-size="xxs"/>
                        <textarea class="form-control" id="review" rows="3" style="resize: none;"></textarea>
                        <div class="d-flex w-100 mt-1"><button type="submit" class="btn btn-primary btn-sm ml-auto">POST</button></div>
                    </form>
                </div>
            </div>

            <!-- TV photos -->
            <div id="detail-photo-carousel">
            <div id="carousel-details-photo" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div th:each="photo,iterStat : ${screenshots}" th:class="${iterStat.index==0}?'carousel-item active':'carousel-item'">
                        <img class="d-block w-100" th:src="@{${photo.screenshot}}" alt="..."/>
                    </div>

                    <!-- buttons -->
                    <a class="carousel-control-prev" href="#carousel-details-photo" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carousel-details-photo" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

                <!-- Indicators -->
                <ol class='carousel-indicators'>
                    <li th:each="photo,iterStat : ${screenshots}" data-target='#carousel-details-photo' th:attr="data-slide-to=${iterStat.index}" th:class="${iterStat.index==0}?'active'">
                        <img th:src="@{${photo.screenshot}}" alt='' />
                    </li>
                </ol>
            </div>
            </div>     

            <!-- TV season info -->
            <div class="jumbotron details-jumbotron">
                <h6 class="border-bottom border-gray pb-2 mb-0">Overview</h6>

                <p class="text-justify"th:text="${tv.overview}"></p>
            </div>

            <!-- Cast Info -->           
            <div class="jumbotron details-jumbotron">
                <h6 class="border-bottom border-gray pb-2 mb-0">Cast info</h6>
                <div id="cast-card-deck" class="card-deck mt-5">
                    <div class="col-sm-4 col-md-3 col-lg-3 mb-3" th:each="actor,iterStat : ${actors}" th:unless="${iterStat.index>7 }">
                        <div class="card" th:if="${ actor!=null and actor.actor!=null}">
                            <a th:href="@{/actor_details(id=${actor.actorId})}" >
                                <img class="card-img-top" th:src="@{${actor.actor.headshot}}" alt="Card image cap"/>
                            </a>
                            <div class="card-body">
                                <p class="card-title" th:text="${actor.actor.firstName+' '+actor.actor.lastName}">Name</p>
                                <p class="card-subtitle" th:text="${actor.role}">role</p>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="mt-4"><a href="#"><p class="text-right">See more</p></a></div>
            </div>


            <div th:unless="${criticReviews.size()>0 or userReviews.size()>0}">
                <h6 class="border-bottom border-gray pb-2 mb-2">REVIEWS</h6>
                <span>No review yet.</span>
            </div>

            <!-- Critic Reviews -->
            <h6 th:if="${criticReviews.size()>0}" class="border-bottom border-gray pb-2 mb-0">CRITIC REVIEWS</h6>
            <div th:each="criticReview,iterStat : ${criticReviews}" th:if="${iterStat.index<10}" class="media flex-md-row pt-3">
                <div class="review-thumbnail-container">
                    <img th:src="@{(${criticReview.critic.photo}?: '/img/default.gif')}" alt="..." class="review-img-thumbnail"/>
                </div>
                <div class="d-flex flex-column align-items-start w-100">
                    <div class="d-flex w-100 mb-1">
                        <div>
                            <span class="ml-2">@</span>
                            <span th:text="|${criticReview.critic.firstName} ${criticReview.critic.lastName}|">@User Name</span>
                        </div>
                        <div class="ml-auto mr-1">Critic score:</div>
                        <div>
                            <span th:text="${criticReview.rating==''?'no score':criticReview.rating}">score</span>
                        </div>
                    </div>
                    <p class="media-body pb-3 mb-0 small lh-125 border-bottom w-100" th:text="${criticReview.review}">
                        Review
                    </p>
                </div>
            </div>

            <!-- User(Audience) Reviews -->
            <h6 th:if="${userReviews.size()>0}" class="border-bottom border-gray pb-2 mb-0 mt-4">USER REVIEWS</h6>
            <div th:each="userReview,iterStat : ${userReviews}" th:if="${iterStat.index<6}" class="media flex-md-row pt-3">
                <div class="review-thumbnail-container">
                    <a th:href="@{/userInformation(userName=${userReview.user.username})}">
                        <img th:src="@{(${userReview.user.photo}?: '/img/default.gif')}" alt="..." class="review-img-thumbnail"/>
                    </a>
                </div>
                <div class="d-flex flex-column align-items-start w-100">
                    <div class="d-flex w-100 mb-1">
                        <div>
                            <a th:href="@{/userInformation(userName=${userReview.user.username})}" style="color: white;">
                                <span class="ml-2">@</span>
                                <span th:text="${userReview.user.username}">User Name</span>
                            </a>
                        </div>
                        <div class="ml-auto mr-1 pt-1">Score:</div>
                        <div class="d-flex">
                            <input class="rating rating-loading score p-0" th:value="${userReview.rating}" data-stars="5" data-min="0" data-max="5" data-size="xxs" disabled=true data-show-clear="false" data-show-caption="false"/>
                            <span th:text="${userReview.rating==''?'score':userReview.rating}" class="pt-1" style="font-size: 20px;">score</span>
                        </div>
                    </div>
                    <p class="media-body pb-3 mb-0 small lh-125 border-bottom w-100" th:text="${userReview.review}" style="min-height: 3rem;">
                        Review
                    </p>
                </div>
            </div>

            <small class="d-block text-right mt-3">
                <a href="#">All reviews</a>
            </small>

        </div>

        <!-- Side chart -->
        <div class="col-sm-12 col-md-7 col-lg-4 md-3">
            <div class="jumbotron-side" style="height: 98%;">
                <h5> New TV Tonight </h5>
                <table class="table table-sm table-dark mb-5">
                    <thead>

                    </thead>
                    <tbody>
                        <tr th:each="tv : ${outNowList}">

                            <td>
                                <a th:text="${tv.title}" th:href="@{/tv_details(id=${tv.tvId})}" style="color: white;">Title</a>
                            </td>
                            <td>
                                <a th:text="${tv.rating}" th:href="@{/tv_details(id=${tv.tvId})}" style="color: white;">Rating</a>
                            </td>
                        </tr>
                    </tbody>

                    </table>


                <h5>Most Poppular TV</h5>
                <table class="table table-sm table-dark mb-5">
                    <thead>

                    </thead>
                    <tbody>
                    <tr th:each="tv: ${popularList}">

                        <td>
                            <a th:text="${tv.title}" th:href="@{/tv_details(id=${tv.tvId})}" style="color: white;">Title</a>
                        </td>
                        <td>
                            <a th:text="${tv.rating}" th:href="@{/tv_details(id=${tv.tvId})}" style="color: white;">Rating</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>


<!-- footer -->
<div th:replace="fragments/footer">Navbar</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="../../js/jquery-3.3.1.min.js" th:src="@{/js/jquery-3.3.1.min.js}"></script>
<script src="../../js/popper.min.js" th:src="@{/js/popper.min.js}"></script>
<script src="../../js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}"></script>
<script src="../../js/star-rating.js" th:src="@{/js/star-rating.js}"></script>
<script>
    $("#show-more-btn").click(function () {
            $("#show-less-btn").show();
            $("#show-more-btn").hide();
        }
    );
    $("#show-less-btn").click(function () {
        $("#show-more-btn").show();
        $("#show-less-btn").hide();
    });
</script>

</body>
</html>
